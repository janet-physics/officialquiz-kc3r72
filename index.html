<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>物理公式クイズ（MathJax版）</title>

<!-- MathJax v3 読み込み -->
<script>
window.MathJax = {
  tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] }
};
</script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>

<style>
  body {
    font-family: Arial, sans-serif;
    margin: 20px;
    background-color: #f4f4f4;
    color: #333;
  }
  h1 { text-align:center; }
  .quiz-container { background:white; padding:20px; border-radius:8px; max-width:650px; margin:auto; }
  .choices button {
    display:block; width:100%; margin:10px 0; padding:10px;
    font-size:18px; border-radius:6px; cursor:pointer;
    background:#eee; border:1px solid #ccc;
  }
  .correct { background:#c8e6c9 !important; } /* 緑 */
  .wrong { background:#ffcdd2 !important; }   /* 赤 */
  #result { margin-top:10px; font-size:18px; font-weight:bold; }
</style>
</head>
<body>

<h1>物理公式クイズ（MathJax版）</h1>

<div class="quiz-container">
  <p id="question"></p>
  <div class="choices" id="choices"></div>
  <p id="result"></p>
  <button id="nextButton" onclick="nextQuestion()" style="display:none;">次の問題へ</button>
</div>

<script>
/* ===============================
   ▼ 14問の問題データ（LaTeX 表記）
=============================== */

const quizData = [
  { q: "直線電流がつくる磁場", a: "$H=\\frac{I}{2\\pi r}$" },
  { q: "円形電流がつくる磁場", a: "$H=\\frac{I}{2r}$" },
  { q: "ソレノイドを流れる電流がつくる磁場", a: "$H=nI$" },
  { q: "磁場中で電流が受ける力", a: "$F=IBL$" },
  { q: "ローレンツ力", a: "$f=qvB$" },
  { q: "ファラデーの電磁誘導の法則", a: "$V=-N\\frac{\\Delta\\Phi}{\\Delta t}$" },
  { q: "自己誘導", a: "$V=-L\\frac{\\Delta I}{\\Delta t}$" },
  { q: "相互誘導", a: "$V=-M\\frac{\\Delta I_1}{\\Delta t}$" },
  { q: "交流電圧の実効値", a: "$V=\\frac{V_0}{\\sqrt{2}}$" },
  { q: "交流電流の実効値", a: "$I=\\frac{I_0}{\\sqrt{2}}$" },
  { q: "コイルのリアクタンス", a: "$X=\\omega L$" },
  { q: "コンデンサーのリアクタンス", a: "$X=\\frac{1}{\\omega C}$" },
  { q: "共振周波数", a: "$f_0=\\frac{1}{2\\pi\\sqrt{LC}}$" },
  { q: "半減期", a: "$N=N_0\\left(\\frac{1}{2}\\right)^{t/T}$" }
];

/* シャッフル */
function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}

let currentIndex = 0;
let score = 0;

/* 問題表示 */
function showQuestion() {
  const q = quizData[currentIndex];
  document.getElementById("question").innerHTML = `Q${currentIndex + 1}. ${q.q}`;

  let choices = [q.a];

  const wrong = quizData
    .filter(item => item.a !== q.a)
    .map(item => item.a);

  shuffle(wrong);
  choices.push(wrong[0], wrong[1]);
  shuffle(choices);

  const choiceDiv = document.getElementById("choices");
  choiceDiv.innerHTML = "";

  choices.forEach(choice => {
    const btn = document.createElement("button");
    btn.innerHTML = `<span class='math'>${choice}</span>`;

    btn.onclick = () => {
      if (choice === q.a) {
        btn.classList.add("correct");
        document.getElementById("result").innerText = "正解！";
        score++;
      } else {
        btn.classList.add("wrong");
        document.getElementById("result").innerText = "不正解…";
      }

      disableButtons();
      document.getElementById("nextButton").style.display = "block";
      MathJax.typeset();
    };

    choiceDiv.appendChild(btn);
  });

  MathJax.typeset();
}

/* ボタン無効化 */
function disableButtons() {
  document.querySelectorAll("#choices button").forEach(btn => btn.disabled = true);
}

/* 次の問題へ */
function nextQuestion() {
  currentIndex++;
  document.getElementById("result").innerText = "";
  document.getElementById("nextButton").style.display = "none";

  if (currentIndex < quizData.length) {
    showQuestion();
  } else {
    finishQuiz();
  }
}

/* 結果表示 */
function finishQuiz() {
  document.querySelector(".quiz-container").innerHTML = `
    <h2>終了！</h2>
    <p>あなたの得点： ${score} / ${quizData.length}</p>
  `;
  MathJax.typeset();
}

/* 初回実行 */
showQuestion();
</script>

</body>
</html>
